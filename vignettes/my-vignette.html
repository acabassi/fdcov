<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Adam B. Kashlak, Alessandra Cabassi" />

<meta name="date" content="2017-12-18" />

<title>R package fdcov</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">R package fdcov</h1>
<h4 class="author"><em>Adam B. Kashlak, Alessandra Cabassi</em></h4>
<h4 class="date"><em>2017-12-18</em></h4>


<div id="TOC">
<ul>
<li><a href="#k-sample-test-for-the-equality-of-covariance-operators"><span class="toc-section-number">1</span> k-sample test for the equality of covariance operators</a><ul>
<li><a href="#kashlaks-test"><span class="toc-section-number">1.1</span> Kashlak’s test</a></li>
<li><a href="#permutation-test"><span class="toc-section-number">1.2</span> Permutation test</a></li>
</ul></li>
<li><a href="#classification"><span class="toc-section-number">2</span> Classification</a></li>
<li><a href="#clustering"><span class="toc-section-number">3</span> Clustering</a></li>
<li><a href="#references"><span class="toc-section-number">4</span> References</a></li>
</ul>
</div>

<p>The R package <code>fdcov</code> (<strong>F</strong>unctional <strong>D</strong>ata <strong>Cov</strong>ariance) contains a collection of tools for performing statistical inference on functional data specifically through an analysis of the covariance structure of the data. It includes two methods for performing a k-sample test for equality of covariance in <code>ksample.perm</code> and <code>ksample.com</code>. For supervised and unsupervised learning, it contains a method to classify functional data with respect to each category’s covariance operator in <code>classif.com</code>, and it contains a method to cluster functional data, <code>cluster.com</code>, again based on the covariance structure of the data.</p>
<p>The current version of this package assumes that all functional data is sampled on the same grid at the same intervals. Future updates are planned to allow for the below methods to interface with the fda package and its functional basis representations of the data.</p>
<div id="k-sample-test-for-the-equality-of-covariance-operators" class="section level1">
<h1><span class="header-section-number">1</span> k-sample test for the equality of covariance operators</h1>
<p>There are two methods for performing a k-sample test for equality of covariance operators.</p>
<div id="kashlaks-test" class="section level2">
<h2><span class="header-section-number">1.1</span> Kashlak’s test</h2>
<p><code>ksample.com</code> uses concentration inequalities.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(fdcov)
<span class="co"># Load in phoneme data</span>
<span class="kw">library</span>(fds)
<span class="co"># Setup data arrays</span>
dat1 =<span class="st"> </span><span class="kw">rbind</span>( <span class="kw">t</span>(aa<span class="op">$</span>y)[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>,], <span class="kw">t</span>(sh<span class="op">$</span>y)[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>,] );
dat2 =<span class="st"> </span><span class="kw">rbind</span>( <span class="kw">t</span>(aa<span class="op">$</span>y)[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>,], <span class="kw">t</span>(ao<span class="op">$</span>y)[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>,] );
dat3 =<span class="st"> </span><span class="kw">rbind</span>( dat1, <span class="kw">t</span>(ao<span class="op">$</span>y)[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>,] );
<span class="co"># Setup group labels</span>
grp1 =<span class="st"> </span><span class="kw">gl</span>(<span class="dv">2</span>,<span class="dv">20</span>);
grp2 =<span class="st"> </span><span class="kw">gl</span>(<span class="dv">2</span>,<span class="dv">20</span>);
grp3 =<span class="st"> </span><span class="kw">gl</span>(<span class="dv">3</span>,<span class="dv">20</span>);
<span class="co"># Compare two disimilar phonemes (should return TRUE)</span>
<span class="kw">ksample.com</span>(dat1,grp1);</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Compare two similar phonemes (should return FALSE)</span>
<span class="kw">ksample.com</span>(dat2,grp2);</code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Compare three phonemes (should return TRUE)</span>
<span class="kw">ksample.com</span>(dat3,grp3);</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="permutation-test" class="section level2">
<h2><span class="header-section-number">1.2</span> Permutation test</h2>
<p><code>ksample.perm</code> can be used to perform the metric-based permutation test for the equality of covariance operators of Cabassi et al. (2017). Again, we use a subset of the data contained in the phoneme dataset from the R package <code>fds</code> to illustrate how to use this function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Create data set
<span class="co"># Load data</span>
<span class="kw">data</span>(aa); <span class="kw">data</span>(ao); <span class="kw">data</span>(dcl); <span class="kw">data</span>(iy); <span class="kw">data</span>(sh) 
<span class="co"># Select 20 observations from each dataset</span>
dat =<span class="st"> </span><span class="kw">cbind</span>(aa<span class="op">$</span>y[,<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>],ao<span class="op">$</span>y[,<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>],dcl<span class="op">$</span>y[,<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>],iy<span class="op">$</span>y[,<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>],sh<span class="op">$</span>y[,<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>]) 
<span class="co"># Input matrix must be of size N (number of observations) X P (number of time points)</span>
dat =<span class="st"> </span><span class="kw">t</span>(dat)
<span class="co"># Define cluster labels</span>
grp =<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">20</span>),<span class="kw">rep</span>(<span class="dv">2</span>,<span class="dv">20</span>),<span class="kw">rep</span>(<span class="dv">3</span>,<span class="dv">20</span>),<span class="kw">rep</span>(<span class="dv">4</span>,<span class="dv">20</span>),<span class="kw">rep</span>(<span class="dv">5</span>,<span class="dv">20</span>)) </code></pre></div>
<p>The function takes as input the dataset <code>dat</code> and the vector of group labels <code>grp</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Test the equality of the covariance operators
p =<span class="st"> </span><span class="kw">ksample.perm</span>(dat, grp, <span class="dt">part =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>The user can also choose the number of iterations of the permutation test <code>iter</code> (the default is <code>1000</code>), the distance between covariance operators <code>dist</code> (the default is <code>sq</code>, the square root distance) and the combining function to find the global p-value <code>comb</code> (the default is <code>tipp</code>, the Tippett combining function). If the data have already been centred around the mean, we suggest to set <code>cent = TRUE</code>. Moreover, if <code>part=FALSE</code>, this function returns only the global p-value. If <code>part=TRUE</code>, it returns a vector that contains both the global p-value (in <code>p$global</code>) and a list of partial p-values, one for each pairwise comparison (in <code>p$partial</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p<span class="op">$</span>global <span class="co"># global p-value</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p<span class="op">$</span>partial <span class="co"># partial p-values</span></code></pre></div>
<pre><code>##         dist p_value signif
## 1-2 30.00486   0.000    ***
## 1-3 28.78225   0.000    ***
## 1-4 30.23026   0.000    ***
## 1-5 30.05272   0.000    ***
## 2-3 26.96973   0.071      .
## 2-4 29.17826   0.000    ***
## 2-5 27.55809   0.000    ***
## 3-4 28.35040   0.000    ***
## 3-5 26.81700   0.000    ***
## 4-5 29.97638   0.000    ***</code></pre>
<p>The values of the observed distances between each pair of covariance operators are also reported in the table. The user can also choose to adjust the p-values with the step-down method of Westfall and Young (1993) by setting <code>adj = TRUE</code> in <code>ksample.perm</code>. For more information about these options please see and Cabassi et al. (2017).</p>
<p>The partial p-values can be plotted using the <code>perm.plot</code> function, that takes as input the list <code>p</code>, output by <code>perm.plot</code>, the number of groups and a vector of strings that indicate the class labels (optional):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">perm.plot</span>(p, <span class="dv">5</span>, <span class="dt">lab=</span><span class="kw">c</span>(<span class="st">'aa'</span>,<span class="st">'ao'</span>,<span class="st">'dcl'</span>,<span class="st">'iy'</span>,<span class="st">'sh'</span>)) <span class="co"># visualise partial p-values</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /> It is also possible to automatically save the figure by setting <code>save = TRUE</code>. The figure will be saved in <code>.eps</code> format. The name of the figure can be customised using the parameter <code>name</code>.</p>
</div>
</div>
<div id="classification" class="section level1">
<h1><span class="header-section-number">2</span> Classification</h1>
<p><code>classif.com</code> trains a covariance operator based functional data classifier that makes use of con- centration inequalities. <code>predict.classif.com</code> uses the previously trained classifier to classify new observations</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(fds);
 <span class="co"># Setup training data</span>
dat1 =<span class="st"> </span><span class="kw">rbind</span>( 
  <span class="kw">t</span>(aa<span class="op">$</span>y[,<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>]), <span class="kw">t</span>(ao<span class="op">$</span>y[,<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>]), <span class="kw">t</span>(dcl<span class="op">$</span>y[,<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>]), 
  <span class="kw">t</span>(iy<span class="op">$</span>y[,<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>]), <span class="kw">t</span>(sh<span class="op">$</span>y[,<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>]) 
);
 <span class="co"># Setup testing data</span>
dat2 =<span class="st"> </span><span class="kw">rbind</span>( 
  <span class="kw">t</span>(aa<span class="op">$</span>y[,<span class="dv">101</span><span class="op">:</span><span class="dv">400</span>]), <span class="kw">t</span>(ao<span class="op">$</span>y[,<span class="dv">101</span><span class="op">:</span><span class="dv">400</span>]), <span class="kw">t</span>(dcl<span class="op">$</span>y[,<span class="dv">101</span><span class="op">:</span><span class="dv">400</span>]), 
  <span class="kw">t</span>(iy<span class="op">$</span>y[,<span class="dv">101</span><span class="op">:</span><span class="dv">400</span>]), <span class="kw">t</span>(sh<span class="op">$</span>y[,<span class="dv">101</span><span class="op">:</span><span class="dv">400</span>]) 
);
 
datgrp =<span class="st"> </span><span class="kw">gl</span>(<span class="dv">5</span>,<span class="dv">100</span>);
clCom =<span class="st"> </span><span class="kw">classif.com</span>( datgrp, dat1 );
grp =<span class="st"> </span><span class="kw">predict</span>( clCom, dat2, <span class="dt">LOADING=</span><span class="ot">FALSE</span> );
acc =<span class="st"> </span><span class="kw">c</span>(
  <span class="kw">sum</span>( grp[<span class="dv">1</span><span class="op">:</span><span class="dv">300</span>]<span class="op">==</span><span class="dv">1</span> ), <span class="kw">sum</span>( grp[<span class="dv">301</span><span class="op">:</span><span class="dv">600</span>]<span class="op">==</span><span class="dv">2</span> ), <span class="kw">sum</span>( grp[<span class="dv">601</span><span class="op">:</span><span class="dv">900</span>]<span class="op">==</span><span class="dv">3</span> ), 
  <span class="kw">sum</span>( grp[<span class="dv">901</span><span class="op">:</span><span class="dv">1200</span>]<span class="op">==</span><span class="dv">4</span> ), <span class="kw">sum</span>( grp[<span class="dv">1201</span><span class="op">:</span><span class="dv">1500</span>]<span class="op">==</span><span class="dv">5</span> )
)<span class="op">/</span><span class="dv">300</span>;
<span class="kw">print</span>(<span class="kw">rbind</span>(<span class="kw">gl</span>(<span class="dv">5</span>,<span class="dv">1</span>),<span class="kw">signif</span>(acc,<span class="dv">3</span>)));</code></pre></div>
<pre><code>##       [,1]  [,2] [,3]  [,4] [,5]
## [1,] 1.000 2.000 3.00 4.000 5.00
## [2,] 0.783 0.797 0.96 0.993 0.99</code></pre>
</div>
<div id="clustering" class="section level1">
<h1><span class="header-section-number">3</span> Clustering</h1>
<p>The figure sizes have been customised so that you can easily put two images side-by-side.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Setup data to be clustered</span>
dat  =<span class="st"> </span><span class="kw">rbind</span>( <span class="kw">t</span>(aa<span class="op">$</span>y[,<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>]),<span class="kw">t</span>(iy<span class="op">$</span>y[,<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>]),<span class="kw">t</span>(sh<span class="op">$</span>y[,<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>]) );
<span class="co"># Cluster data into three groups</span>
clst =<span class="st"> </span><span class="kw">cluster.com</span>(dat,<span class="dt">grpCnt=</span><span class="dv">3</span>,<span class="dt">PRINTLK =</span> <span class="ot">FALSE</span>);
<span class="kw">matrix</span>(clst,<span class="dv">3</span>,<span class="dv">20</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>);</code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] [,11] [,12] [,13]
## [1,]    2    3    3    2    2    2    2    3    2     3     2     2     2
## [2,]    3    3    3    3    3    3    3    3    3     1     2     3     3
## [3,]    1    1    1    1    1    1    1    1    1     1     1     1     1
##      [,14] [,15] [,16] [,17] [,18] [,19] [,20]
## [1,]     3     2     2     2     2     3     2
## [2,]     3     3     3     1     3     3     1
## [3,]     1     1     1     1     1     1     1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># cluster groups of curves</span>
dat  =<span class="st"> </span><span class="kw">rbind</span>( <span class="kw">t</span>(aa<span class="op">$</span>y[,<span class="dv">1</span><span class="op">:</span><span class="dv">40</span>]),<span class="kw">t</span>(iy<span class="op">$</span>y[,<span class="dv">1</span><span class="op">:</span><span class="dv">40</span>]),<span class="kw">t</span>(sh<span class="op">$</span>y[,<span class="dv">1</span><span class="op">:</span><span class="dv">40</span>]) );
lab  =<span class="st"> </span><span class="kw">gl</span>(<span class="dv">30</span>,<span class="dv">4</span>);
<span class="co"># Cluster data into three groups</span>
clst =<span class="st"> </span><span class="kw">cluster.com</span>(dat,<span class="dt">labl=</span>lab,<span class="dt">grpCnt=</span><span class="dv">3</span>,<span class="dt">PRINTLK =</span> <span class="ot">FALSE</span>);
<span class="kw">matrix</span>(clst,<span class="dv">3</span>,<span class="dv">10</span>,<span class="dt">byrow=</span><span class="ot">TRUE</span>);</code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]
## [1,]    1    1    1    1    1    1    1    1    1     1
## [2,]    2    2    2    2    2    2    2    2    2     2
## [3,]    3    3    3    3    3    3    3    3    3     3</code></pre>
</div>
<div id="references" class="section level1">
<h1><span class="header-section-number">4</span> References</h1>
<p>Cabassi, A., Pigoli, D., Secchi, P., Carter, P. A. (2017). Permutation tests for the equality of covariance operators of functional data with applications to evolutionary biology. Electron. J. Statist. 11(2), pp.3815–3840.</p>
<p>Kashlak, A.B., Aston, J.A. and Nickl, R., (2016). Inference on covariance operators via concentration inequalities: k-sample tests, classification, and clustering via Rademacher complexities. arXiv preprint arXiv:1604.06310.</p>
<p>Pigoli, D., Aston, J.A., Dryden, I.L. and Secchi, P., (2014). Distances and inference for covariance operators. Biometrika, 101(2), pp.409-422.</p>
<p>Westfall, P. H. and Young, S. S. (1993). Resampling-based multiple testing: Examples and methods for p-value adjustment, volume 279. John Wiley &amp; Sons.</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
